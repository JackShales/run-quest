<h1><%= @quest.name %></h1>
<h3><%= @quest.quest_type %> Quest</h3>
<h5>Assigned by <%= @assigner.char_name %> to <%= "#{@assignee.char_name}, #{@quest.status}" %></h5>
<p><%= @quest.notes %></p>
<p><%= @quest.deadline %></p>

<div ng-app="app">
  <div ng-controller="activityCtrl" ng-init="setup()">
    <div>
      <label>
        Sync activity to quest:
      </label>
        <input ng-model="dateFilter" list="startTimes">
        <datalist id="startTimes">
          <option ng-repeat="activity in activities">{{ activity.start_time }}</option>
        </datalist>
    </div>
    <div ng-repeat="activity in activities | filter: { startTime: dateFilter }">
      <p ng-if="userActivity(activity, <%= current_user.id %>)">Run on {{ activity.startTime }}</p>
    </div>
  </div>
</div>



<% if @quest.status_code == 1 && current_user.id == @quest.assignee_id %>
<%= form_tag "/quests/#{@quest.id}", method: :patch do %>
    <%= check_box_tag :choice, 3 %>
    <%= label_tag :choice_cancel, "Cancel Quest" %>
    <%= submit_tag "Submit" %>
  <% end %>
<% end %>

<% if @quest.status_code == 1 && current_user.id == @quest.assigner_id %>
  <%= form_tag "/quests/#{@quest.id}", method: :patch do %>
    <%= radio_button_tag :choice, 4 %>
    <%= label_tag :choice_complete, "Quest Completed" %>
    <%= radio_button_tag :choice, 3 %>
    <%= label_tag :choice_cancel, "Cancel Quest" %>
    <%= submit_tag "Submit" %>
  <% end %>
<% end %>